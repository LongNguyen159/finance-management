import{a as fe,b as ve,c as Ce,d as Se,f as ye}from"./chunk-22JCRPYB.js";import{a as B,b as E}from"./chunk-TI2CCOLC.js";import{C as le,J as ce,K as de,L as ge,M as pe,O as he,Q as me,R as ue,a as J,b as Q,j as ae,l as re,t as se}from"./chunk-NQBCJVKG.js";import{N as O,P as oe,t as ne}from"./chunk-QTWUJ5OJ.js";import"./chunk-EJJBCPAK.js";import{f as q,k as X,l as H,n as x,p as D,ra as Z,sa as ee,ta as te,wa as ie}from"./chunk-6XGTMRGJ.js";import{$b as L,Cb as l,Db as s,Eb as d,Fb as W,Gb as $,Ib as P,Lb as M,Lc as z,Mc as Y,Nb as h,Tc as K,U as N,Uc as U,Xa as r,Xb as g,Yb as V,ac as G,bc as F,cc as T,dc as b,ea as p,ia as S,ib as R,nb as f,pa as y,qa as w,ra as k,rb as c,xb as u,zc as _}from"./chunk-MQ3VJMD5.js";import{a as j,b as A}from"./chunk-GAL4ENT6.js";var be=(()=>{class n{constructor(){this.actualSpending=[],this.budget=[],this.colorService=p(D),this.options=this.getBaseOptions(),this.mergeOptions={},this.SCALE_FACTOR=1.25,_(()=>{this.updateChart()})}getBaseOptions(){return{tooltip:{},legend:{top:0,textStyle:{color:this.colorService.isDarkMode()?this.colorService.darkTextPrimary:this.colorService.lightTextPrimary}},radar:{},series:[]}}ngOnChanges(e){(e&&e.budget||e.actualSpending)&&this.updateChart()}updateChart(){if(this.budget.length==0||this.actualSpending.length==0)return;let e=this.actualSpending.filter(o=>o.value>0&&this.budget.some(a=>a.category===o.category&&a.value>0)).map(o=>{let a=this.budget.find(C=>C.category===o.category),I=(a?Math.max(a.value,o.value):o.value)*this.SCALE_FACTOR;return{name:x[o.category].label,min:0,max:void 0}}),i=this.actualSpending.filter(o=>o.value>0&&this.budget.some(a=>a.category===o.category&&a.value>0)).map(o=>o.value),t=this.actualSpending.filter(o=>o.value>0&&this.budget.some(a=>a.category===o.category&&a.value>0)).map(o=>{let a=this.budget.find(v=>v.category===o.category);return a?a.value:0});this.mergeOptions=A(j({},this.getBaseOptions()),{radar:{indicator:e,shape:"circle",scale:!0,axisLine:{lineStyle:{color:this.colorService.isDarkMode()?"rgba(204, 204, 204, 0.7)":"rgba(144, 144, 144, 1)"}},splitLine:{lineStyle:{color:["rgba(144, 144, 144, 0.1)","rgba(144, 144, 144, 0.2)","rgba(144, 144, 144, 0.4)","rgba(144, 144, 144, 0.6)","rgba(144, 144, 144, 0.8)","rgba(144, 144, 144, 1)"].reverse()}}},series:[{type:"radar",symbol:"none",data:[{value:i,name:"Actual Spending",itemStyle:{color:this.colorService.isDarkMode()?this.colorService.redDarkMode:this.colorService.redLightMode},lineStyle:{width:2,color:this.colorService.isDarkMode()?this.colorService.redDarkMode:this.colorService.redLightMode,cap:"round"},areaStyle:{color:this.colorService.isDarkMode()?this.colorService.redDarkMode:this.colorService.redLightMode,opacity:.7}},{value:t,name:"Budget",itemStyle:{color:this.colorService.isDarkMode()?this.colorService.greenDarkMode:this.colorService.greenLightMode},lineStyle:{width:2,color:this.colorService.isDarkMode()?this.colorService.greenDarkMode:this.colorService.greenLightMode},areaStyle:{color:this.colorService.isDarkMode()?this.colorService.greenDarkMode:this.colorService.greenLightMode,opacity:.5}}]}]})}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=S({type:n,selectors:[["app-budget-radar-chart"]],inputs:{actualSpending:"actualSpending",budget:"budget"},standalone:!0,features:[T([E()]),y,b],decls:1,vars:2,consts:[["echarts","",2,"height","500px",3,"options","merge"]],template:function(i,t){i&1&&d(0,"div",0),i&2&&c("options",t.options)("merge",t.mergeOptions)},dependencies:[B]})}}return n})();var _e=(()=>{class n{constructor(){this.budget=0,this.actualSpending=1,this.title="",this.color="#000",this.colorService=p(D),this.currencyService=p(le),this.chartOptions=this.getBaseOptions(),this.mergeOptions={},this.spendingPercentage=0,_(()=>{this.updateChart()})}getBaseOptions(){return{}}ngOnChanges(e){(e&&e.budget||e.actualSpending||e.color)&&this.updateChart()}computeBudgetPercentage(){return this.spendingPercentage=Math.round(this.actualSpending/this.budget*100),this.spendingPercentage}getColorBasedOnPercentage(){return this.spendingPercentage<=50?this.colorService.isDarkMode()?this.colorService.greenDarkMode:this.colorService.greenLightMode:this.spendingPercentage<=75?this.colorService.isDarkMode()?"#f5da5f":"rgb(242,201,107)":this.spendingPercentage<=100?"#ffa550":this.colorService.isDarkMode()?"rgb(221,83,76)":"#ef4444"}updateChart(){let e=this.title,i=20;if(this.title.includes("&")){let[o,a]=this.title.split("&").map(v=>v.trim());e=`${o} &
${a}`,i=16}let t=[{value:this.computeBudgetPercentage(),name:e}];this.mergeOptions={series:[{type:"gauge",startAngle:90,endAngle:-270,pointer:{show:!1},progress:{show:!0,overlap:!1,roundCap:!0,clip:!1,itemStyle:{borderWidth:1,color:this.getColorBasedOnPercentage()}},axisLine:{lineStyle:{width:20,color:this.colorService.isDarkMode()?[[1,"rgb(70,70,70)"]]:[[1,"rgb(240,240,240)"]]}},splitLine:{show:!1,distance:0,length:10},axisTick:{show:!1},axisLabel:{show:!1,distance:50},data:t,title:{fontSize:22,offsetCenter:["0%","-30%"],fontWeight:"bold",color:this.colorService.isDarkMode()?this.colorService.darkTextPrimary:this.colorService.lightTextPrimary},detail:{fontSize:16,color:this.getColorBasedOnPercentage(),formatter:()=>{let o=Math.round(this.actualSpending*100)/100,a=this.budget,v=Math.abs(a-o),I=O(v,this.currencyService.getCurrencySymbol(this.currencyService.getSelectedCurrency())),C="";return o<a?C=`${I} left`:o>a?C=`${I} overspent`:C="On budget",`(${this.computeBudgetPercentage()}%)
${O(o,this.currencyService.getCurrencySymbol(this.currencyService.getSelectedCurrency()))} / ${O(a,this.currencyService.getCurrencySymbol(this.currencyService.getSelectedCurrency()))}
${C}`},valueAnimation:!0,offsetCenter:["0%","30%"]}}]}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=S({type:n,selectors:[["app-budget-gauge-chart"]],inputs:{budget:"budget",actualSpending:"actualSpending",title:"title",color:"color"},standalone:!0,features:[T([E(),K]),y,b],decls:1,vars:2,consts:[["echarts","",2,"height","100%","min-height","380px","width","100%",3,"options","merge"]],template:function(i,t){i&1&&d(0,"div",0),i&2&&c("options",t.chartOptions)("merge",t.mergeOptions)},dependencies:[B]})}}return n})();function De(n,m){if(n&1){let e=P();l(0,"button",22),M("click",function(){w(e);let t=h();return k(t.navigateToBudgetList())}),g(1," Edit Budgets "),s()}}function xe(n,m){n&1&&(l(0,"p",14),g(1," Budget Charts will appear here once you enter your actual spending on the set budgets. "),s())}function we(n,m){if(n&1){let e=P();l(0,"div",15)(1,"p"),g(2,"No budgets set yet!"),s(),l(3,"button",23),M("click",function(){w(e);let t=h();return k(t.navigateToBudgetList())}),g(4,"Create One Now"),s()()}}function ke(n,m){if(n&1){let e=P();l(0,"div",17)(1,"div",8),g(2,"Show Gauge Chart"),s(),l(3,"div")(4,"mat-slide-toggle",9),F("ngModelChange",function(t){w(e);let o=h();return G(o.showGaugeChart,t)||(o.showGaugeChart=t),k(t)}),s()()()}if(n&2){let e=h();r(4),L("ngModel",e.showGaugeChart)}}function Pe(n,m){if(n&1&&(l(0,"section"),d(1,"app-budget-radar-chart",24),s()),n&2){let e=h();r(),c("budget",e.budgets)("actualSpending",e.spending)}}function Te(n,m){if(n&1&&(W(0),d(1,"app-budget-gauge-chart",27),$()),n&2){let e=m.$implicit,i=h(2);r(),c("title",e.label)("budget",i.getBudgetValue(e.value))("actualSpending",i.getActualSpendingValue(e.value))("color",i.colorService.isDarkMode()?e.colorDark||"rgb(92, 144, 247)":e.colorLight||"rgb(90, 111, 192)")}}function Oe(n,m){if(n&1&&(l(0,"section")(1,"div",25),f(2,Te,2,4,"ng-container",26),s()()),n&2){let e=h();r(2),c("ngForOf",e.indicators)}}function Be(n,m){if(n&1&&(l(0,"section")(1,"div",28),d(2,"app-treemap-chart",29),s()()),n&2){let e=h();r(2),c("treeData",e.treeMapData)("totalExpenses",e.totalExpenses)("totalNetIncome",e.totalNetIncome)}}function Ee(n,m){if(n&1&&(l(0,"section"),d(1,"app-pie-chart",30),s()),n&2){let e=h();r(),c("pieChartData",e.pieChartDataBrutto)("chartTitle","Total Gross Income Distribution")("totalIncome",e.totalGrossIncome)}}var Bt=(()=>{class n extends ce{constructor(){super(),this.hasMonthPicker=!0,this.hasNavbar=!1,this.selectedMonth=new Date,this.isVerticalLayout=!0,this.dataService=p(oe),this.colorService=p(D),this.dialogService=p(me),this.budgetService=p(Se),this.router=p(q),this.monthlyData={},this.highlightMonths=[],this.totalExpenses=-1,this.totalGrossIncome=-1,this.totalNetIncome=-1,this.showGrossIncomePieChart=!1,this.pieChartDataBrutto=[],this.pieChartDataNetto=[],this.isDarkmode=!1,this.categories=Object.values(x),this.budgets=[],this.spending=[],this.treeMapData=[],this.indicators=[],this.showGaugeChart=!0,this.isSankeyVertical=!1,this.viewTreeMap=!1,_(()=>{this.budgets=this.budgetService.budget()})}ngOnInit(){this.budgets=this.budgetService.getBudgets(),this.dataService.getAllMonthsData().pipe(N(this.componentDestroyed$)).subscribe(e=>{let i=Object.keys(e).reduce((t,o)=>{let a=e[o];return(a.rawInput.length>0||a.totalGrossIncome>0||a.totalExpenses>0)&&(t[o]=a),t},{});this.monthlyData=i,this.highlightMonths=Object.keys(i)}),this.dataService.getSingleMonthData().pipe(N(this.componentDestroyed$)).subscribe(e=>{e&&Object.keys(e).length>0&&(this.entriesOfOneMonth=e,this.pieChartDataNetto=e.pieData,this.totalExpenses=e.totalExpenses,this.totalGrossIncome=e.totalGrossIncome,this.totalNetIncome=e.totalUsableIncome,this.treeMapData=e.treeMapData,this.getBudgetData(),this.entriesOfOneMonth.totalTax==0?(this.showGrossIncomePieChart=!1,this.pieChartDataBrutto=this.pieChartDataNetto):(this.showGrossIncomePieChart=!0,this.pieChartDataBrutto=[...this.pieChartDataNetto,{name:"Taxes",value:this.entriesOfOneMonth.totalTax}],this.totalGrossIncome=this.entriesOfOneMonth.totalGrossIncome))})}getBudgetData(){let e=this.pieChartDataNetto.filter(i=>i.name.includes(H)).map(i=>({category:i.name,value:i.value}));this.spending=e,this.indicators=e.filter(i=>i.value>0&&this.budgets.some(t=>t.category===i.category&&t.value>0)).map(i=>x[i.category]),this.indicators.length<=2?this.showGaugeChart=!0:this.indicators.length>2&&(this.showGaugeChart=!1)}getBudgetValue(e){let i=this.budgets.find(t=>t.category===e);return i?i.value:0}getActualSpendingValue(e){let i=this.spending.find(t=>t.category===e);return i?i.value:0}navigateToBudgetList(){this.router.navigate([X.FinanceManagerPage],{queryParams:{tab:1}})}ngOnChanges(e){e&&e.selectedMonth}onMonthChanges(e){he(e.currentMonth,this.monthlyData,this.entriesOfOneMonth,this.dataService)}toggleLayout(){this.isVerticalLayout=!this.isVerticalLayout}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=S({type:n,selectors:[["app-main-page"]],inputs:{hasMonthPicker:"hasMonthPicker",hasNavbar:"hasNavbar",selectedMonth:"selectedMonth"},standalone:!0,features:[R,y,b],decls:42,vars:25,consts:[[1,"flex","flex-col"],[1,"navbar",3,"showBackButton"],[3,"monthSelected","highlightedMonths"],[1,"p-4","pt-0"],[3,"ngClass"],[1,"flex","flex-col","gap-8"],[1,"flex","flex-row","w-full","items-center","justify-end","gap-2"],[1,"flex","flex-row","items-center","gap-1"],[1,"text-sm"],["color","primary","labelPosition","before",3,"ngModelChange","ngModel"],[3,"sankeyData","remainingBalance","orientation"],[1,"flex","flex-col","w-full","items-center","justify-center"],[1,"font-bold"],["mat-button",""],[1,"mt-4"],[1,"flex","flex-col","w-full","justify-center","items-center","gap-2"],[1,"flex","flex-row","w-full","items-center","justify-end"],[1,"flex","flex-row","w-full","items-center","justify-end","gap-1"],["mat-button","",1,"flex","flex-row","items-center",3,"click"],["mat-button","",1,"flex","items-center",3,"click"],[1,"mr-1"],[3,"showPieChart","pieChartData","chartTitle","totalIncome","totalExpenses"],["mat-button","",3,"click"],["mat-stroked-button","","color","primary",3,"click"],[3,"budget","actualSpending"],[1,"gauge-chart-container"],[4,"ngFor","ngForOf"],[3,"title","budget","actualSpending","color"],[1,"flex","flex-row","w-full","justify-center"],[1,"w-[80%]",3,"treeData","totalExpenses","totalNetIncome"],[3,"pieChartData","chartTitle","totalIncome"]],template:function(i,t){i&1&&(l(0,"div",0)(1,"app-navbar",1)(2,"app-month-picker",2),M("monthSelected",function(a){return t.onMonthChanges(a)}),s()(),l(3,"div",3)(4,"div",4)(5,"div",5)(6,"section")(7,"div",6)(8,"div",7)(9,"div",8),g(10,"Vertical View"),s(),l(11,"div")(12,"mat-slide-toggle",9),F("ngModelChange",function(a){return G(t.isSankeyVertical,a)||(t.isSankeyVertical=a),a}),s()()()(),d(13,"app-sankey-chart",10),s(),d(14,"mat-divider",4),l(15,"div",11)(16,"h2",12),g(17," Budget vs Actual Spending "),s(),f(18,De,2,0,"button",13)(19,xe,2,0,"p",14),s(),f(20,we,5,0,"div",15),l(21,"div",16),f(22,ke,5,1,"div",17),s(),f(23,Pe,2,2,"section")(24,Oe,3,1,"section"),d(25,"mat-divider",4),l(26,"section")(27,"div",6)(28,"button",18),M("click",function(){return t.viewTreeMap=!t.viewTreeMap}),l(29,"mat-icon"),g(30),s(),l(31,"span"),g(32),s()(),l(33,"button",19),M("click",function(){return t.dialogService.openDidYouKnowDialog()}),l(34,"mat-icon",20),g(35,"lightbulb_outline"),s(),l(36,"span"),g(37,"Did You Know?"),s()()(),d(38,"app-pie-chart",21),f(39,Be,3,3,"section"),s(),d(40,"mat-divider",4),f(41,Ee,2,3,"section"),s()()()()),i&2&&(r(),c("showBackButton",!1),r(),c("highlightedMonths",t.highlightMonths),r(2),c("ngClass",t.isVerticalLayout?"flex flex-col p-4":"grid grid-cols-2 gap-8 p-4"),r(8),L("ngModel",t.isSankeyVertical),r(),c("sankeyData",t.entriesOfOneMonth.sankeyData)("remainingBalance",t.entriesOfOneMonth.remainingBalance)("orientation",t.isSankeyVertical?"vertical":"horizontal"),r(),c("ngClass",t.colorService.isDarkMode()?"!border-gray-700":"!border-gray-300"),r(4),u(t.budgets.length!==0?18:-1),r(),u(t.indicators.length==0&&t.budgets.length!==0?19:-1),r(),u(t.budgets.length==0?20:-1),r(2),u(t.indicators.length>2?22:-1),r(),u(t.indicators.length>2?23:-1),r(),u(t.showGaugeChart?24:-1),r(),c("ngClass",t.colorService.isDarkMode()?"!border-gray-700":"!border-gray-300"),r(5),V(t.viewTreeMap?"pie_chart":"map"),r(2),V(t.viewTreeMap?"View Pie Chart":"View Tree Map"),r(6),c("showPieChart",!t.viewTreeMap)("pieChartData",t.pieChartDataNetto)("chartTitle","Net Income Distribution")("totalIncome",t.totalNetIncome)("totalExpenses",t.totalExpenses),r(),u(t.viewTreeMap?39:-1),r(),c("ngClass",t.colorService.isDarkMode()?"!border-gray-700":"!border-gray-300"),r(),u(t.showGrossIncomePieChart?41:-1))},dependencies:[Ce,ve,ie,te,U,z,Y,ee,Z,ne,Q,J,ue,pe,fe,be,_e,ge,de,se,ae,re,ye],styles:[".gauge-chart-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:16px}"]})}}return n})();export{Bt as MainPageComponent};
